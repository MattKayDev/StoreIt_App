
{
  "rules": {
    ".read": "auth != null",
    ".write": "auth != null",
    "items": {
      "$itemId": {
        ".validate": "newData.hasChildren(['name', 'description', 'location', 'imageUrl']) && newData.child('name').isString() && newData.child('name').val().length > 0 && newData.child('description').isString() && newData.child('location').isString() && newData.child('location').val().length > 0 && newData.child('imageUrl').isString()"
      }
    },
    "locations": {
      "$locationId": {
        ".validate": "newData.hasChild('name') && newData.child('name').isString() && newData.child('name').val().length > 0"
      }
    },
    "activity": {
      "$logId": {
        // Log entries are append-only
        ".write": "!data.exists() && newData.child('loggedBy').val() === auth.token.name",
        ".validate": "newData.hasChildren(['itemId', 'itemName', 'action', 'loggedBy', 'loggedAt']) && (newData.child('action').val() === 'Created' || newData.child('action').val() === 'Updated' || newData.child('action').val() === 'Moved' || newData.child('action').val() === 'Deleted')"
      }
    }
  }
}
